}
else if(distrib[[i]] == "poisson"){
gf_shape = "pois"
fd_p <- fitdistr(data, "poisson")
est_lambda = fd_p$estimate[[1]]
ks = ks.test(data, "ppois", lambda=est_lambda)
# add to results
results[i,] = c(gf_shape, est_lambda, 0, ks$statistic, ks$p.value)
}
else if(distrib[[i]] == "weibull"){
gf_shape = "weibull"
fd_w <- fitdistr(data,densfun=dweibull,start=list(scale=1,shape=2))
est_shape = fd_w$estimate[[1]]
est_scale = fd_w$estimate[[2]]
ks = ks.test(data, "pweibull", shape=est_shape, scale=est_scale)
# add to results
results[i,] = c(gf_shape, est_shape, est_scale, ks$statistic, ks$p.value)
}
else if(distrib[[i]] == "normal"){
gf_shape = "norm"
fd_n <- fitdistr(data, "normal")
est_mean = fd_n$estimate[[1]]
est_sd = fd_n$estimate[[2]]
ks = ks.test(data, "pnorm", mean=est_mean, sd=est_sd)
# add to results
results[i,] = c(gf_shape, est_mean, est_sd, ks$statistic, ks$p.value)
}
else if(distrib[[i]] == "exponential"){
gf_shape = "exp"
fd_e <- fitdistr(data, "exponential")
est_rate = fd_e$estimate[[1]]
ks = ks.test(data, "pexp", rate=est_rate)
# add to results
results[i,] = c(gf_shape, est_rate, 0, ks$statistic, ks$p.value)
}
else if(distrib[[i]] == "logistic"){
gf_shape = "logis"
fd_l <- fitdistr(data, "logistic")
est_location = fd_l$estimate[[1]]
est_scale = fd_l$estimate[[2]]
ks = ks.test(data, "plogis", location=est_location, scale=est_scale)
# add to results
results[i,] = c(gf_shape, est_location, est_scale, ks$statistic, ks$p.value)
}
else if(distrib[[i]] == "lognormal"){
gf_shape = "lnorm"
fd_l <- fitdistr(data, "lognormal")
est_meanlog = fd_l$estimate[[1]]
est_sdlog = fd_l$estimate[[2]]
ks = ks.test(data, "plnorm", meanlog=est_meanlog, sdlog=est_sdlog)
# add to results
results[i,] = c(gf_shape, est_meanlog, est_sdlog, ks$statistic, ks$p.value)
}
}
#   results = rbind(c("distribution", "param1", "param2", "ks stat", "ks pvalue"), results)
cname = c("distribution", "param1", "param2", "ks stat", "ks pvalue")
results = data.frame(results)
colnames(results) = cname
#print(results)
return(results)
}
data <- AB$a
res = fitData(data, fit=c("logistic", "normal", "exponential", "poisson", "weibull", "lognormal"), sample=1)
as.integer(as.character(res[2,2]))
as.numeric(as.character(res[2,2]))
res[2,2]
res
res[2,2]$levels
names(res[2,2])
as.numeric(levels(res[2,2])[res[2,2]])
levels(res[2,2])[res[2,2]]
options(digits)
options(digits = 15)
levels(res[2,2])[res[2,2]]
as.numeric(as.character(res))
res
as.numeric(as.character(res[1,2]))
par(mar=c(5.1,4.1,1.1,1.1))
hist(data, freq=FALSE, xlim=c(0,300), ylim=c(0,0.025), main="", xlab=expression(USR~beta[1]~Values))
rug(data)
rng <- seq(0,250,0.1)
lines(density(data), lwd=2, lty=2)  #, bw="SJ"
lines(rng, dlogis(rng, as.numeric(as.character(res[1,2])), as.numeric(as.character(res[1,3]))), col="red", lwd=2)
lines(dlogis(rng, as.numeric(as.character(res[1,2])), as.numeric(as.character(res[1,3]))), col="red", lwd=2)
lines(density(rlogis(length(data), as.numeric(as.character(res[1,2])), as.numeric(as.character(res[1,3]))), col="red", lwd=2)
lines(density(rlogis(length(data), as.numeric(as.character(res[1,2])), as.numeric(as.character(res[1,3])))), col="red", lwd=2)
hist(data, freq=FALSE, xlim=c(0,300), ylim=c(0,0.025), main="", xlab=expression(USR~beta[1]~Values))
rug(data)
rng <- seq(0,250,0.1)
lines(density(data), lwd=2, lty=2)  #, bw="SJ"
lines(rng, dlogis(rng, as.numeric(as.character(res[1,2])), as.numeric(as.character(res[1,3]))), col="red", lwd=2)
lines(dlogis(rng, as.numeric(as.character(res[1,2])), as.numeric(as.character(res[1,3]))), col="red", lwd=2)
lines(density(rlogis(length(data), as.numeric(as.character(res[1,2])), as.numeric(as.character(res[1,3])))), col="red", lwd=2)
hist(data, freq=FALSE, xlim=c(0,300), ylim=c(0,0.025), main="", xlab=expression(USR~beta[1]~Values))
rug(data)
rng <- seq(0,250,0.1)
lines(density(data), lwd=2, lty=2)  #, bw="SJ"
lines(rng, dlogis(rng, as.numeric(as.character(res[1,2])), as.numeric(as.character(res[1,3]))), col="red", lwd=2)
lines(dlogis(rng, as.numeric(as.character(res[1,2])), as.numeric(as.character(res[1,3]))), col="red", lwd=2)
lines(density(rlogis(length(data), as.numeric(as.character(res[1,2])), as.numeric(as.character(res[1,3])))), col="red", lwd=2)
par(mar=c(5.1,4.1,1.1,1.1))
hist(data, freq=FALSE, xlim=c(0,300), ylim=c(0,0.025), main="", xlab=expression(USR~beta[1]~Values))
rug(data)
rng <- seq(0,250,0.1)
lines(density(data), lwd=2, lty=2)  #, bw="SJ"
lines(rng, dlogis(rng, as.numeric(as.character(res[1,2])), as.numeric(as.character(res[1,3]))), col="red", lwd=2)
lines(rng, dnorm(rng, as.numeric(as.character(res[2,2])), as.numeric(as.character(res[2,3]))), col="blue", lwd=2)
lines(rng, dexp(rng, as.numeric(as.character(res[3,2])), col="Chartreuse4", lwd=2)
lines(rng, dexp(rng, as.numeric(as.character(res[3,2]))), col="Chartreuse4", lwd=2)
lines(density(data), lwd=2, lty=2)  #, bw="SJ"
lines(rng, dlogis(rng, as.numeric(as.character(res[1,2])), as.numeric(as.character(res[1,3]))), col="red", lwd=2)
lines(rng, dnorm(rng, as.numeric(as.character(res[2,2])), as.numeric(as.character(res[2,3]))), col="blue", lwd=2)
lines(rng, dexp(rng, as.numeric(as.character(res[3,2]))), col="Chartreuse4", lwd=2)
lines(rng, dweibull(rng, as.numeric(as.character(res[5,2])), as.numeric(as.character(res[5,3]))), col="darkorange2", lwd=2)
dweibull(rng, as.numeric(as.character(res[5,2])), as.numeric(as.character(res[5,3])))
rng
rng <- seq(0,xlimit[2],0.1)
rng
xlimit <- c(0,300)
ylimit <- c(0.0.01)
ylimit <- c(0,0.01)
par(mar=c(5.1,4.1,1.1,1.1))
hist(data, freq=FALSE, xlim=xlimit, ylim=ylimit, main="", xlab=expression(USR~beta[1]~Values))
rug(data)
rng <- seq(0,xlimit[2],0.1)
lines(density(data), lwd=2, lty=2)  #, bw="SJ"
names(hist(data, plot=FALSE))
hist(data, plot=FALSE)$density
hist(data, plot=FALSE)$density
names(density(data))
density(data)$y
max(density(data)$y)
max(hist(data, plot=FALSE)$density, density(data)$y)
(signif(max(hist(data, plot=FALSE)$density, density(data)$y)),2)
signif(max(hist(data, plot=FALSE)$density, density(data)$y),2)
xlimit <- c(0,300)
ylimit <- c(0,0.006)
par(mar=c(5.1,4.1,1.1,1.1))
hist(data, freq=FALSE, xlim=xlimit, ylim=ylimit, main="", xlab=expression(USR~beta[1]~Values))
rug(data)
rng <- seq(0,xlimit[2],0.1)
lines(density(data), lwd=2, lty=2)  #, bw="SJ"
lines(rng, dlogis(rng, as.numeric(as.character(res[1,2])), as.numeric(as.character(res[1,3]))), col="red", lwd=2)
lines(rng, dnorm(rng, as.numeric(as.character(res[2,2])), as.numeric(as.character(res[2,3]))), col="blue", lwd=2)
lines(rng, dexp(rng, as.numeric(as.character(res[3,2]))), col="Chartreuse4", lwd=2)
lines(rng, dweibull(rng, as.numeric(as.character(res[5,2])), as.numeric(as.character(res[5,3]))), col="darkorange2", lwd=2)
lines(rng, dlnorm(rng, as.numeric(as.character(res[6,2])), as.numeric(as.character(res[6,3]))), col="cyan3", lwd=2)
legend("topright", legend=c("data density", "logistic","normal","exponential", "weibull","log-normal"),
col=c("black","red","blue","chartreuse4","darkorange2","cyan3"),
lty=c(2,1,1,1,1,1), lwd=c(2,2,2,2,2,2))
ylimit <- c(0,0.01)
par(mar=c(5.1,4.1,1.1,1.1))
hist(data, freq=FALSE, xlim=xlimit, ylim=ylimit, main="", xlab=expression(USR~beta[1]~Values))
rug(data)
rng <- seq(0,xlimit[2],0.1)
lines(density(data), lwd=2, lty=2)  #, bw="SJ"
lines(rng, dlogis(rng, as.numeric(as.character(res[1,2])), as.numeric(as.character(res[1,3]))), col="red", lwd=2)
lines(rng, dnorm(rng, as.numeric(as.character(res[2,2])), as.numeric(as.character(res[2,3]))), col="blue", lwd=2)
lines(rng, dexp(rng, as.numeric(as.character(res[3,2]))), col="Chartreuse4", lwd=2)
lines(rng, dweibull(rng, as.numeric(as.character(res[5,2])), as.numeric(as.character(res[5,3]))), col="darkorange2", lwd=2)
lines(rng, dlnorm(rng, as.numeric(as.character(res[6,2])), as.numeric(as.character(res[6,3]))), col="cyan3", lwd=2)
legend("topright", legend=c("data density", "logistic","normal","exponential", "weibull","log-normal"),
col=c("black","red","blue","chartreuse4","darkorange2","cyan3"),
lty=c(2,1,1,1,1,1), lwd=c(2,2,2,2,2,2))
xlimit <- c(0,300)
ylimit <- c(0,0.008)
par(mar=c(5.1,4.1,1.1,1.1))
hist(data, freq=FALSE, xlim=xlimit, ylim=ylimit, main="", xlab=expression(USR~beta[1]~Values))
rug(data)
rng <- seq(0,xlimit[2],0.1)
lines(density(data), lwd=2, lty=2)  #, bw="SJ"
lines(rng, dlogis(rng, as.numeric(as.character(res[1,2])), as.numeric(as.character(res[1,3]))), col="red", lwd=2)
lines(rng, dnorm(rng, as.numeric(as.character(res[2,2])), as.numeric(as.character(res[2,3]))), col="blue", lwd=2)
lines(rng, dexp(rng, as.numeric(as.character(res[3,2]))), col="Chartreuse4", lwd=2)
lines(rng, dweibull(rng, as.numeric(as.character(res[5,2])), as.numeric(as.character(res[5,3]))), col="darkorange2", lwd=2)
lines(rng, dlnorm(rng, as.numeric(as.character(res[6,2])), as.numeric(as.character(res[6,3]))), col="cyan3", lwd=2)
legend("topright", legend=c("data density", "logistic","normal","exponential", "weibull","log-normal"),
col=c("black","red","blue","chartreuse4","darkorange2","cyan3"),
lty=c(2,1,1,1,1,1), lwd=c(2,2,2,2,2,2))
lines(density(data, bw="SJ"), lwd=2, lty=2)  #, bw="SJ"
lines(density(data), lwd=2, lty=2)  #, bw="SJ"
dev.off()
xlimit <- c(0,300)
ylimit <- c(0,0.008)
par(mar=c(5.1,4.1,1.1,1.1))
hist(data, freq=FALSE, xlim=xlimit, ylim=ylimit, main="", xlab=expression(USR~beta[1]~Values))
rug(data)
rng <- seq(0,xlimit[2],0.1)
lines(density(data), lwd=2, lty=2)  #, bw="SJ"
lines(rng, dlogis(rng, as.numeric(as.character(res[1,2])), as.numeric(as.character(res[1,3]))), col="red", lwd=2)
lines(rng, dnorm(rng, as.numeric(as.character(res[2,2])), as.numeric(as.character(res[2,3]))), col="blue", lwd=2)
lines(rng, dexp(rng, as.numeric(as.character(res[3,2]))), col="Chartreuse4", lwd=2)
lines(rng, dweibull(rng, as.numeric(as.character(res[5,2])), as.numeric(as.character(res[5,3]))), col="darkorange2", lwd=2)
lines(rng, dlnorm(rng, as.numeric(as.character(res[6,2])), as.numeric(as.character(res[6,3]))), col="cyan3", lwd=2)
legend("topright", legend=c("data density", "logistic","normal","exponential", "weibull","log-normal"),
col=c("black","red","blue","chartreuse4","darkorange2","cyan3"),
lty=c(2,1,1,1,1,1), lwd=c(2,2,2,2,2,2))
dev.off()
setwd(plotFile)
getwd()
setwd(plotFile)
pdf("USR B1 Dist.pdf", width=6, height=6, family="Times")
xlimit <- c(0,300)
ylimit <- c(0,0.008)
par(mar=c(5.1,4.1,1.1,1.1))
hist(data, freq=FALSE, xlim=xlimit, ylim=ylimit, main="", xlab=expression(USR~beta[1]~Values))
rug(data)
rng <- seq(0,xlimit[2],0.1)
lines(density(data), lwd=2, lty=2)  #, bw="SJ"
lines(rng, dlogis(rng, as.numeric(as.character(res[1,2])), as.numeric(as.character(res[1,3]))), col="red", lwd=2)
lines(rng, dnorm(rng, as.numeric(as.character(res[2,2])), as.numeric(as.character(res[2,3]))), col="blue", lwd=2)
lines(rng, dexp(rng, as.numeric(as.character(res[3,2]))), col="Chartreuse4", lwd=2)
lines(rng, dweibull(rng, as.numeric(as.character(res[5,2])), as.numeric(as.character(res[5,3]))), col="darkorange2", lwd=2)
lines(rng, dlnorm(rng, as.numeric(as.character(res[6,2])), as.numeric(as.character(res[6,3]))), col="cyan3", lwd=2)
legend("topright", legend=c("data density", "logistic","normal","exponential", "weibull","log-normal"),
col=c("black","red","blue","chartreuse4","darkorange2","cyan3"),
lty=c(2,1,1,1,1,1), lwd=c(2,2,2,2,2,2))
dev.off()
setwd(modelsFile)
USRB1 <- fitdistr(data, "logistic")
data
USRB1
help(fitdistr)
summary(USRB1)
plot(USRB1)
plot(summary(USRB1))
names(USRB1)
USRB1$est
USRB1$sd
USRB1
7.53/41.89
127.83/16.80*100
16.80/127.83*100
AFit <- c(USRB1$est[[1]], USRB1$est[[2]])
fittest <- dtrunc(rng, "logis", a=0, location=AFit[[1]], scale=AFit[[2]])
Arandom <- rtrunc(5000, "logis", a=0, location=AFit[[1]], scale=AFit[[2]])
par(mar=c(5.1,4.1,1.1,1.1))
hist(data, freq=FALSE, xlim=c(0,150), ylim=c(0,0.025), main="", xlab=expression(USR~beta[1]~Values))
rug(data)
lines(density(data, bw="SJ"), lwd=2, lty=2)
lines(rng,fittest, lwd=2, col="red")
lines(density(Arandom, bw="SJ"), lwd=2, lty=2, col="red")
legend("topright", legend=c("data density", "truncated logistic","random truncated logistic"),
col=c("black","red","red"),
lty=c(2,1,2), lwd=c(2,2,2))
hist(data, freq=FALSE, xlim=xlimit, ylim=ylimit, main="", xlab=expression(USR~beta[1]~Values))
rug(data)
lines(density(data, bw="SJ"), lwd=2, lty=2)
hist(data, freq=FALSE, xlim=xlimit, ylim=ylimit, main="", xlab=expression(USR~beta[1]~Values))
rug(data)
lines(density(data), lwd=2, lty=2)
lines(rng,fittest, lwd=2, col="red")
lines(density(Arandom, bw="SJ"), lwd=2, lty=2, col="red")
lines(density(Arandom), lwd=2, lty=2, col="red")
legend("topright", legend=c("data density", "truncated logistic","random truncated logistic"),
col=c("black","red","red"),
lty=c(2,1,2), lwd=c(2,2,2))
par(mar=c(5.1,4.1,1.1,1.1))
hist(data, freq=FALSE, xlim=xlimit, ylim=ylimit, main="", xlab=expression(USR~beta[1]~Values))
rug(data)
lines(density(data), lwd=2, lty=2)
lines(rng,fittest, lwd=2, col="red")
lines(density(Arandom), lwd=2, lty=2, col="red")
legend("topright", legend=c("data density", "truncated logistic","random truncated logistic"),
col=c("black","red","red"),
lty=c(2,1,2), lwd=c(2,2,2))
dev.off()
setwd(plotFile)
pdf("USR B1 Dist Check.pdf", width=6, height=6, family="Times")
par(mar=c(5.1,4.1,1.1,1.1))
hist(data, freq=FALSE, xlim=xlimit, ylim=ylimit, main="", xlab=expression(USR~beta[1]~Values))
rug(data)
lines(density(data), lwd=2, lty=2)
lines(rng,fittest, lwd=2, col="red")
lines(density(Arandom), lwd=2, lty=2, col="red")
legend("topright", legend=c("data density", "truncated logistic","random truncated logistic"),
col=c("black","red","red"),
lty=c(2,1,2), lwd=c(2,2,2))
dev.off()
data <- AB$b
res = fitData(data, fit=c("logistic", "normal", "exponential", "poisson", "weibull", "lognormal"), sample=1)
write.table(res, file="USR B2 K-S values.csv", sep="\t") #view the data set to choose the best fit
par(mar=c(5.1,4.1,1.1,1.1))
hist(data, freq=FALSE, xlim=c(0,1.5), ylim=c(0,3), main="", xlab=expression(USR~beta[2]~Values))
range(data)
par(mar=c(5.1,4.1,1.1,1.1))
xlim <- c(0,1.6)
ylim <- c(0,3)
hist(data, freq=FALSE, xlim=xlimit, ylim=ylimit, main="", xlab=expression(USR~beta[2]~Values))
range(data)
xlimit <- c(0,1.5)
ylimit <- c(0,3)
hist(data, freq=FALSE, xlim=xlimit, ylim=ylimit, main="", xlab=expression(USR~beta[2]~Values))
xlimit <- c(0,1.6)
ylimit <- c(0,3)
hist(data, freq=FALSE, xlim=xlimit, ylim=ylimit, main="", xlab=expression(USR~beta[2]~Values))
xlimit <- c(0,1.7)
ylimit <- c(0,3)
hist(data, freq=FALSE, xlim=xlimit, ylim=ylimit, main="", xlab=expression(USR~beta[2]~Values))
xlimit <- c(0,1.8)
ylimit <- c(0,3)
hist(data, freq=FALSE, xlim=xlimit, ylim=ylimit, main="", xlab=expression(USR~beta[2]~Values))
xlimit <- c(0,2.0)
ylimit <- c(0,3)
hist(data, freq=FALSE, xlim=xlimit, ylim=ylimit, main="", xlab=expression(USR~beta[2]~Values))
rug(data)
rng <- seq(0,1.5,0.1)
rng <- seq(0,2.0,0.1)
lines(density(data), lwd=2, lty=2)
res
lines(density(data), lwd=2, lty=2)
lines(rng, dlogis(rng, as.numeric(as.character(res[1,2])), as.numeric(as.character(res[1,3]))), col="red", lwd=2)
lines(rng, dnorm(rng, as.numeric(as.character(res[2,2])), as.numeric(as.character(res[2,3]))), col="blue", lwd=2)
lines(rng, dexp(rng, as.numeric(as.character(res[3,2]))), col="Chartreuse4", lwd=2)
lines(rng, dweibull(rng, as.numeric(as.character(res[5,2])), as.numeric(as.character(res[5,3]))), col="darkorange2", lwd=2)
lines(rng, dlnorm(rng, as.numeric(as.character(res[6,2])), as.numeric(as.character(res[6,3]))), col="cyan3", lwd=2)
xlimit <- c(0,2.0)
ylimit <- c(0,2.1)
hist(data, freq=FALSE, xlim=xlimit, ylim=ylimit, main="", xlab=expression(USR~beta[2]~Values))
rug(data)
rng <- seq(0,2.0,0.1)
lines(density(data), lwd=2, lty=2)
lines(rng, dlogis(rng, as.numeric(as.character(res[1,2])), as.numeric(as.character(res[1,3]))), col="red", lwd=2)
lines(rng, dnorm(rng, as.numeric(as.character(res[2,2])), as.numeric(as.character(res[2,3]))), col="blue", lwd=2)
lines(rng, dexp(rng, as.numeric(as.character(res[3,2]))), col="Chartreuse4", lwd=2)
lines(rng, dweibull(rng, as.numeric(as.character(res[5,2])), as.numeric(as.character(res[5,3]))), col="darkorange2", lwd=2)
lines(rng, dlnorm(rng, as.numeric(as.character(res[6,2])), as.numeric(as.character(res[6,3]))), col="cyan3", lwd=2)
legend("topright", legend=c("data density", "logistic","normal","exponential", "weibull","log-normal"),
col=c("black","red","blue","chartreuse4","darkorange2","cyan3"),
lty=c(2,1,1,1,1,1), lwd=c(2,2,2,2,2,2))
dev.off()
###################################
setwd(plotFile)
pdf("USR B2 Dist.pdf", width=6, height=6, family="Times")
par(mar=c(5.1,4.1,1.1,1.1))
xlimit <- c(0,2.0)
ylimit <- c(0,2.1)
hist(data, freq=FALSE, xlim=xlimit, ylim=ylimit, main="", xlab=expression(USR~beta[2]~Values))
rug(data)
rng <- seq(0,2.0,0.1)
lines(density(data), lwd=2, lty=2)
lines(rng, dlogis(rng, as.numeric(as.character(res[1,2])), as.numeric(as.character(res[1,3]))), col="red", lwd=2)
lines(rng, dnorm(rng, as.numeric(as.character(res[2,2])), as.numeric(as.character(res[2,3]))), col="blue", lwd=2)
lines(rng, dexp(rng, as.numeric(as.character(res[3,2]))), col="Chartreuse4", lwd=2)
lines(rng, dweibull(rng, as.numeric(as.character(res[5,2])), as.numeric(as.character(res[5,3]))), col="darkorange2", lwd=2)
lines(rng, dlnorm(rng, as.numeric(as.character(res[6,2])), as.numeric(as.character(res[6,3]))), col="cyan3", lwd=2)
legend("topright", legend=c("data density", "logistic","normal","exponential", "weibull","log-normal"),
col=c("black","red","blue","chartreuse4","darkorange2","cyan3"),
lty=c(2,1,1,1,1,1), lwd=c(2,2,2,2,2,2))
dev.off()
###################################
### --- Chosen Distribution --- ###
# Log-normal
USRB2 <- fitdistr(data, "lognormal")
setwd(modelsFile)
USRB2 <- fitdistr(data, "lognormal")
save(USRB2, file="USRB2.Rdata")
### --- Chosen Distribution --- ###
###################################
BFit <- c(USRB2$est[[1]], USRB2$est[[2]])
fittest <- dlnorm(rng, meanlog=BFit[[1]], sdlog=BFit[[2]])
Brandom <- rlnorm(5000, meanlog=BFit[[1]], sdlog=BFit[[2]])
setwd(plotFile)
par(mar=c(5.1,4.1,1.1,1.1))
par(mar=c(5.1,4.1,1.1,1.1))
hist(data, freq=FALSE, xlim=xlimit, ylim=ylimit, main="", xlab=expression(USR~beta[2]~Values))
rug(data)
lines(density(data), lwd=2, lty=2)
lines(rng,fittest, lwd=2, col="cyan3")
lines(density(Brandom), lwd=2, lty=2, col="cyan3")
legend("topright", legend=c("data density", "log-normal","random log-normal"),
col=c("black","cyan3","cyan3"),
lty=c(2,1,2), lwd=c(2,2,2))
dev.off()
setwd(plotFile)
pdf("USR B2 Dist Check.pdf", width=6, height=6, family="Times")
par(mar=c(5.1,4.1,1.1,1.1))
hist(data, freq=FALSE, xlim=xlimit, ylim=ylimit, main="", xlab=expression(USR~beta[2]~Values))
rug(data)
lines(density(data), lwd=2, lty=2)
lines(rng,fittest, lwd=2, col="cyan3")
lines(density(Brandom), lwd=2, lty=2, col="cyan3")
legend("topright", legend=c("data density", "log-normal","random log-normal"),
col=c("black","cyan3","cyan3"),
lty=c(2,1,2), lwd=c(2,2,2))
dev.off()
# Residual Distribution ----
data <- AB$rse
res = fitData(data, fit=c("logistic", "normal", "exponential", "poisson", "weibull", "lognormal"), sample=1)
data <- AB$rse
res = fitData(data, fit=c("logistic", "normal", "exponential", "poisson", "weibull", "lognormal"), sample=1)
setwd(resultsFile)
write.table(res, file="USR B1B2 Error K-S values.txt", sep="\t") #view the data set to choose the best fit
setwd(plotFile)
par(mar=c(5.1,4.1,1.1,1.1))
xlimit <- c(0,15)
ylimit <- c(0,0.5)
hist(data, freq=FALSE, xlim=xlimit, ylim=ylimit, main="", xlab=expression(USR~Geometry~Residual~Values))
range(data)
xlimit <- c(0,35)
ylimit <- c(0,0.5)
hist(data, freq=FALSE, xlim=xlimit, ylim=ylimit, main="", xlab=expression(USR~Geometry~Residual~Values))
rug(data)
rng <- seq(0,xlimit[2],0.1)
lines(density(data), lwd=2, lty=2)
xlimit <- c(0,35)
ylimit <- c(0,0.5)
hist(data, freq=FALSE, xlim=xlimit, ylim=ylimit, main="", xlab=expression(USR~Geometry~Residual~Values))
rug(data)
rng <- seq(0,xlimit[2],0.1)
lines(density(data), lwd=2, lty=2)
lines(rng, dlogis(rng, as.numeric(as.character(res[2,2])), as.numeric(as.character(res[2,3]))), col="red", lwd=2)
lines(rng, dnorm(rng, as.numeric(as.character(res[3,2])), as.numeric(as.character(res[3,3]))), col="blue", lwd=2)
lines(rng, dexp(rng, as.numeric(as.character(res[4,2]))), col="Chartreuse4", lwd=2)
xlimit <- c(0,35)
ylimit <- c(0,0.5)
hist(data, freq=FALSE, xlim=xlimit, ylim=ylimit, main="", xlab=expression(USR~Geometry~Residual~Values))
rug(data)
rng <- seq(0,xlimit[2],0.1)
lines(density(data), lwd=2, lty=2)
lines(rng, dlogis(rng, as.numeric(as.character(res[1,2])), as.numeric(as.character(res[1,3]))), col="red", lwd=2)
lines(rng, dnorm(rng, as.numeric(as.character(res[2,2])), as.numeric(as.character(res[2,3]))), col="blue", lwd=2)
lines(rng, dexp(rng, as.numeric(as.character(res[3,2]))), col="Chartreuse4", lwd=2)
lines(rng, dweibull(rng, as.numeric(as.character(res[5,2])), as.numeric(as.character(res[5,3]))), col="darkorange2", lwd=2)
lines(rng, dlnorm(rng, as.numeric(as.character(res[6,2])), as.numeric(as.character(res[6,3]))), col="cyan3", lwd=2)
legend("topright", legend=c("data density", "logistic","normal","exponential", "weibull","log-normal"),
col=c("black","red","blue","chartreuse4","darkorange2","cyan3"),
lty=c(2,1,1,1,1,1), lwd=c(2,2,2,2,2,2))
ylimit <- c(0,0.2)
hist(data, freq=FALSE, xlim=xlimit, ylim=ylimit, main="", xlab=expression(USR~Geometry~Residual~Values))
rug(data)
rng <- seq(0,xlimit[2],0.1)
lines(density(data), lwd=2, lty=2)
lines(rng, dlogis(rng, as.numeric(as.character(res[1,2])), as.numeric(as.character(res[1,3]))), col="red", lwd=2)
lines(rng, dnorm(rng, as.numeric(as.character(res[2,2])), as.numeric(as.character(res[2,3]))), col="blue", lwd=2)
lines(rng, dexp(rng, as.numeric(as.character(res[3,2]))), col="Chartreuse4", lwd=2)
lines(rng, dweibull(rng, as.numeric(as.character(res[5,2])), as.numeric(as.character(res[5,3]))), col="darkorange2", lwd=2)
lines(rng, dlnorm(rng, as.numeric(as.character(res[6,2])), as.numeric(as.character(res[6,3]))), col="cyan3", lwd=2)
legend("topright", legend=c("data density", "logistic","normal","exponential", "weibull","log-normal"),
col=c("black","red","blue","chartreuse4","darkorange2","cyan3"),
lty=c(2,1,1,1,1,1), lwd=c(2,2,2,2,2,2))
par(mar=c(5.1,4.1,1.1,1.1))
xlimit <- c(0,35)
ylimit <- c(0,0.15)
hist(data, freq=FALSE, xlim=xlimit, ylim=ylimit, main="", xlab=expression(USR~Geometry~Residual~Values))
rug(data)
rng <- seq(0,xlimit[2],0.1)
lines(density(data), lwd=2, lty=2)
lines(rng, dlogis(rng, as.numeric(as.character(res[1,2])), as.numeric(as.character(res[1,3]))), col="red", lwd=2)
lines(rng, dnorm(rng, as.numeric(as.character(res[2,2])), as.numeric(as.character(res[2,3]))), col="blue", lwd=2)
lines(rng, dexp(rng, as.numeric(as.character(res[3,2]))), col="Chartreuse4", lwd=2)
lines(rng, dweibull(rng, as.numeric(as.character(res[5,2])), as.numeric(as.character(res[5,3]))), col="darkorange2", lwd=2)
lines(rng, dlnorm(rng, as.numeric(as.character(res[6,2])), as.numeric(as.character(res[6,3]))), col="cyan3", lwd=2)
legend("topright", legend=c("data density", "logistic","normal","exponential", "weibull","log-normal"),
col=c("black","red","blue","chartreuse4","darkorange2","cyan3"),
lty=c(2,1,1,1,1,1), lwd=c(2,2,2,2,2,2))
dev.off()
setwd(plotFile)
pdf("USR AB Error Dist.pdf", width=6, height=6, family="Times")
par(mar=c(5.1,4.1,1.1,1.1))
xlimit <- c(0,35)
ylimit <- c(0,0.15)
hist(data, freq=FALSE, xlim=xlimit, ylim=ylimit, main="", xlab=expression(USR~Geometry~Residual~Values))
rug(data)
rng <- seq(0,xlimit[2],0.1)
lines(density(data), lwd=2, lty=2)
lines(rng, dlogis(rng, as.numeric(as.character(res[1,2])), as.numeric(as.character(res[1,3]))), col="red", lwd=2)
lines(rng, dnorm(rng, as.numeric(as.character(res[2,2])), as.numeric(as.character(res[2,3]))), col="blue", lwd=2)
lines(rng, dexp(rng, as.numeric(as.character(res[3,2]))), col="Chartreuse4", lwd=2)
lines(rng, dweibull(rng, as.numeric(as.character(res[5,2])), as.numeric(as.character(res[5,3]))), col="darkorange2", lwd=2)
lines(rng, dlnorm(rng, as.numeric(as.character(res[6,2])), as.numeric(as.character(res[6,3]))), col="cyan3", lwd=2)
legend("topright", legend=c("data density", "logistic","normal","exponential", "weibull","log-normal"),
col=c("black","red","blue","chartreuse4","darkorange2","cyan3"),
lty=c(2,1,1,1,1,1), lwd=c(2,2,2,2,2,2))
dev.off()
###################################
### --- Chosen Distribution --- ###
# Logistic
setwd(modelsFile)
USRBe <- fitdistr(data, "logistic")
save(USRBe, file="USRBe.Rdata")
### --- Chosen Distribution --- ###
###################################
RFit <- c(USRBe$est[[1]], USRBe$est[[2]])
fittest <- dtrunc(rng, "logis", a=0, location=RFit[[1]], scale=RFit[[2]])
Rrandom <- rtrunc(5000, "logis", a=0, location=RFit[[1]], scale=RFit[[2]])
setwd(plotFile)
par(mar=c(5.1,4.1,1.1,1.1))
par(mar=c(5.1,4.1,1.1,1.1))
hist(data, freq=FALSE, xlim=xlimit, ylim=ylimit, main="", xlab=expression(USR~Geometry~Residual~Values))
rug(data)
lines(density(data), lwd=2, lty=2)
lines(rng,fittest, lwd=2, col="red")
lines(density(Rrandom), lwd=2, lty=2, col="red")
legend("topright", legend=c("data density", "log-normal","random log-normal"),
col=c("black","red","red"),
lty=c(2,1,2), lwd=c(2,2,2))
dev.off()
setwd(plotFile)
pdf("USR AB Error Dist Check.pdf", width=6, height=6, family="Times")
par(mar=c(5.1,4.1,1.1,1.1))
hist(data, freq=FALSE, xlim=xlimit, ylim=ylimit, main="", xlab=expression(USR~Geometry~Residual~Values))
rug(data)
lines(density(data), lwd=2, lty=2)
lines(rng,fittest, lwd=2, col="red")
lines(density(Rrandom), lwd=2, lty=2, col="red")
legend("topright", legend=c("data density", "log-normal","random log-normal"),
col=c("black","red","red"),
lty=c(2,1,2), lwd=c(2,2,2))
dev.off()
rm(list=ls())
source('~/Projects/Thesis/Thesis-Calcs/R/USR/02 Survey Analysis and Plots.r')
